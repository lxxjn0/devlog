---
title: ì½”ë“œ ë¶„ì„ ë„êµ¬ ì ìš©ê¸° - 3í¸, SonarQube ì ìš©í•˜ê¸°
date: 2020-11-09 21:00:00
description: use SonarQube on Project
tags:
  - Woowacourse
  - SonarQube
  - Code analysis
slug: /static-code-analysis-part-3
banner: ./images/hero.png
---

> ì´ ê¸€ì€ ìš°ì•„í•œí…Œí¬ì½”ìŠ¤ì—ì„œ ì§„í–‰í•œ í”„ë¡œì íŠ¸ì¸ [ì§ê³ ë˜ì˜ ê¸°ìˆ  ë¸”ë¡œê·¸](https://seller-lee.github.io/static-code-analysis-part3)ì— í•¨ê»˜ ê²Œì‹œëœ ê¸€ì…ë‹ˆë‹¤.

<br/>

ì•ˆë…•í•˜ì„¸ìš”. ìš°ì•„í•œí…Œí¬ì½”ìŠ¤ 2ê¸°, ì…€ëŸ¬ë¦¬ ì»´í¼ë‹ˆì—ì„œ [ì§ê³ ë˜](https://sites.google.com/woowahan.com/wooteco-demo/%EC%A7%81%EA%B3%A0%EB%9E%98)ë¥¼ ê°œë°œí•˜ê³  ìˆëŠ” ìŠ¤í‹°ì¹˜ì…ë‹ˆë‹¤.

![stitch](./images/stitch.jpg)

[ì½”ë“œ ì»¤ë²„ë¦¬ì§€ ë¶„ì„ ë„êµ¬ ì ìš©ê¸° - 2í¸, JaCoCo ì ìš©í•˜ê¸°](https://lxxjn0-dev.netlify.app/java-code-coverage-tool-part-2)ì— ì´ì–´ì„œ, ì´ë²ˆì—ëŠ” í”„ë¡œì íŠ¸ì— **ì •ì  ì½”ë“œ ë¶„ì„ ë„êµ¬ì¸ SonarQubeë¥¼ ì–´ë–»ê²Œ ì ìš©í–ˆëŠ”ì§€**ì— ëŒ€í•´ ì†Œê°œí•´ë“œë¦¬ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## SonarQubeë€?

![SonarQube](./images/sonarqube.png)

### ì •ì  ì½”ë“œ ë¶„ì„ ë„êµ¬

> **ì •ì  í”„ë¡œê·¸ë¨ ë¶„ì„**(static program analysis)ì€ ì‹¤ì œ ì‹¤í–‰ ì—†ì´ ì»´í“¨í„° ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë¶„ì„í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. ëŒ€ë¶€ë¶„ì˜ ê²½ìš°ì— ë¶„ì„ì€ [ì†ŒìŠ¤ ì½”ë“œ](https://ko.wikipedia.org/wiki/ì†ŒìŠ¤_ì½”ë“œ)ì˜ ë²„ì „ ì¤‘ í•˜ë‚˜ì˜ í˜•íƒœë¡œ ìˆ˜í–‰ë˜ë©°, ê°€ë”ì€ [ëª©ì  íŒŒì¼](https://ko.wikipedia.org/wiki/ëª©ì _íŒŒì¼) í˜•íƒœë¡œ ë¶„ì„ëœë‹¤. ì´ì— ë°˜í•˜ì—¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œê·¸ë¨ì„ ë¶„ì„í•˜ëŠ” ê²ƒì„ [ë™ì  í”„ë¡œê·¸ë¨ ë¶„ì„](https://ko.wikipedia.org/wiki/ë™ì _í”„ë¡œê·¸ë¨_ë¶„ì„)ì´ë¼ê³  í•œë‹¤. - [wikipedia](https://ko.wikipedia.org/wiki/%EC%A0%95%EC%A0%81_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8_%EB%B6%84%EC%84%9D)

ê°„ë‹¨í•˜ê²Œ ì •ì  ë¶„ì„ì€ í”„ë¡œê·¸ë¨ì„ **ì‹¤í–‰í•˜ì§€ ì•Šì€ ìƒíƒœ**ì—ì„œ ì†ŒìŠ¤ ì½”ë“œë‚˜ ì»´íŒŒì¼ëœ ì½”ë“œë¥¼ ì´ìš©í•´ í”„ë¡œê·¸ë¨ì„ ë¶„ì„í•˜ëŠ” ë°©ë²•ì´ë©°, ë™ì  ë¶„ì„ì€ í”„ë¡œê·¸ë¨ì„ ì‹¤ì œ í™˜ê²½ì´ë‚˜ ê°€ìƒ í™˜ê²½ì—ì„œ **ì‹¤í–‰í•´ ë³´ë©´ì„œ** ë¶„ì„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

ì •ì  ë¶„ì„ì€ ì†ŒìŠ¤ ì½”ë“œì˜ ëª¨ë“  ë¶€ë¶„ì„ í™•ì¸í•  ìˆ˜ ìˆì§€ë§Œ, ì‹¤í–‰ í™˜ê²½ì—ì„œì˜ ìƒíƒœë¥¼ ì •í™•íˆ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì‹¤í–‰í•  ë•Œì—ë§Œ ì•Œ ìˆ˜ ìˆëŠ” ë°ì´í„°ê°€ í•„ìš”í•œ ê²½ìš° ì •í™•íˆ ë¶„ì„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë°˜ëŒ€ë¡œ ë™ì  ë¶„ì„ì€ ì‹¤ì œë¡œ ì‹¤í–‰í•´ ë³´ë©´ì„œ ë¶„ì„í•˜ê¸° ë•Œë¬¸ì— ì‹¤í–‰ í™˜ê²½ì—ì„œì˜ ìƒíƒœë¥¼ ì˜ ì•Œ ìˆ˜ ìˆì§€ë§Œ, í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ êµ¬ì¶•í•˜ê¸° ì–´ë ¤ìš¸ ë•Œê°€ ë§ê³  ì†ŒìŠ¤ ì½”ë“œì˜ ëª¨ë“  ë¶€ë¶„ì„ í…ŒìŠ¤íŠ¸í•´ ë³´ê¸° í˜ë“¤ë‹¤ëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.

ì´ë ‡ê²Œ ê° ë¶„ì„ ë°©ì‹ì€ ì¥ë‹¨ì ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ì •ì  ë¶„ì„ì€ ì£¼ë¡œ ê°œë°œ ë‹¨ê³„ì—ì„œ ì†ŒìŠ¤ ì½”ë“œì˜ êµ¬ì¡°ì ì¸ ë¬¸ì œë‚˜ ì‹¤ìˆ˜ë¥¼ ì°¾ì•„ë‚´ëŠ” ë° ì‚¬ìš©í•˜ë©° ë™ì  ë¶„ì„ì€ í…ŒìŠ¤íŠ¸ë‚˜ ëª¨ë‹ˆí„°ë§í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

|             | ì •ì  ë¶„ì„(Static analysis)   | ë™ì  ë¶„ì„(Dynamic analysis) |
| ----------- | ---------------------------- | --------------------------- |
| ë¶„ì„ ëŒ€ìƒ   | ì†ŒìŠ¤ ì½”ë“œ ë˜ëŠ” ì»´íŒŒì¼ëœ ì½”ë“œ | í”„ë¡œê·¸ë¨ ì‹¤í–‰ í™˜ê²½          |
| í…ŒìŠ¤íŠ¸ ë²”ìœ„ | ì†ŒìŠ¤ ì½”ë“œì˜ ëª¨ë“  ë¶€ë¶„        | ì‹¤í–‰ ê°€ëŠ¥í•œ ê²½ë¡œ            |
| í™œìš©        | ì½”ë“œ ìƒì˜ ë¬¸ì œë‚˜ ì‹¤ìˆ˜ë¥¼ ì°¾ìŒ | í…ŒìŠ¤íŠ¸, ëª¨ë‹ˆí„°              |

### SonarQube

> **ì†Œë‚˜íë¸Œ**(SonarQube, ì´ì „ ì´ë¦„: **ì†Œë‚˜**/Sonar)[[2\]](https://ko.wikipedia.org/wiki/ì†Œë‚˜íë¸Œ#cite_note-2)ëŠ” 20ê°œ ì´ìƒì˜ [í”„ë¡œê·¸ë˜ë° ì–¸ì–´](https://ko.wikipedia.org/wiki/í”„ë¡œê·¸ë˜ë°_ì–¸ì–´)ì—ì„œ [ë²„ê·¸](https://ko.wikipedia.org/wiki/ì†Œí”„íŠ¸ì›¨ì–´_ë²„ê·¸), [ì½”ë“œ ìŠ¤ë©œ](https://ko.wikipedia.org/wiki/ì½”ë“œ_ìŠ¤ë©œ), ë³´ì•ˆ ì·¨ì•½ì ì„ ë°œê²¬í•  ëª©ì ìœ¼ë¡œ ì •ì  [ì½”ë“œ ë¶„ì„](https://ko.wikipedia.org/wiki/ì •ì _í”„ë¡œê·¸ë¨_ë¶„ì„)ìœ¼ë¡œ ìë™ ë¦¬ë·°ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ì§€ì†ì ì¸ [ì½”ë“œ í’ˆì§ˆ](https://ko.wikipedia.org/wiki/ì†Œí”„íŠ¸ì›¨ì–´_í’ˆì§ˆ) ê²€ì‚¬ìš© [ì˜¤í”ˆ ì†ŒìŠ¤](https://ko.wikipedia.org/wiki/ì˜¤í”ˆ_ì†ŒìŠ¤_ì†Œí”„íŠ¸ì›¨ì–´) í”Œë«í¼ì´ë‹¤. [ì†Œë‚˜ì†ŒìŠ¤](https://ko.wikipedia.org/w/index.php?title=ì†Œë‚˜ì†ŒìŠ¤&action=edit&redlink=1)(SonarSource)ê°€ ê°œë°œí•˜ì˜€ë‹¤. ì†Œë‚˜íë¸ŒëŠ” [ì¤‘ë³µ ì½”ë“œ](https://ko.wikipedia.org/wiki/ì¤‘ë³µ_ì½”ë“œ), [ì½”ë”© í‘œì¤€](https://ko.wikipedia.org/wiki/í”„ë¡œê·¸ë˜ë°_ì½”ë“œ_ì‘ì„±), [ìœ ë‹› í…ŒìŠ¤íŠ¸](https://ko.wikipedia.org/wiki/ìœ ë‹›_í…ŒìŠ¤íŠ¸), [ì½”ë“œ ì»¤ë²„ë¦¬ì§€](https://ko.wikipedia.org/wiki/ì½”ë“œ_ì»¤ë²„ë¦¬ì§€), [ì½”ë“œ ë³µì¡ë„](https://ko.wikipedia.org/w/index.php?title=ìˆœí™˜_ë³µì¡ë„&action=edit&redlink=1), [ì£¼ì„](https://ko.wikipedia.org/wiki/ì£¼ì„_(í”„ë¡œê·¸ë˜ë°)), [ë²„ê·¸](https://ko.wikipedia.org/wiki/ë°©ì–´ì _í”„ë¡œê·¸ë˜ë°) ë° ë³´ì•ˆ ì·¨ì•½ì ì˜ ë³´ê³ ì„œë¥¼ ì œê³µí•œë‹¤.

**SonarQube**ëŠ” ìœ„ì—ì„œ ì†Œê°œí•œ **ì •ì  ì½”ë“œ ë¶„ì„ ë„êµ¬** ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.

ì •ì  ì½”ë“œ ë¶„ì„ ë„êµ¬ì—ëŠ” PMD, FindBugs, CheckStyle ë“±ì´ ìˆìŠµë‹ˆë‹¤. ì €í¬ íŒ€ì—ì„œ SonarQubeë¥¼ ì„ íƒí•˜ê²Œ ëœ ì£¼ëœ ì´ìœ ëŠ” **ë ˆí¼ëŸ°ìŠ¤ê°€ ë§ê³ ** Githubì´ë‚˜ Jenkinsì™€ì˜ ì—°ë™ì„ í†µí•´ ìë™ ì •ì  ì½”ë“œ ë¶„ì„ì„ êµ¬ì„±í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

~~(ì‚¬ì‹¤ ë ˆí¼ëŸ°ìŠ¤ê°€ ë§ë‹¤ëŠ” ì ì´ ì„ íƒí•œ ì´ìœ  ì¤‘ 90%ê°€ ë„˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤)~~

ê·¸ë ‡ë‹¤ë©´ SonarQubeì˜ ì¥ì ì—ëŠ” ì–´ë–¤ ê²ƒì´ ìˆì„ê¹Œìš”?

- ì§€ì†ì ì¸ ì¸ìŠ¤í™ì…˜

  - ì§€ì†ì ì¸ í†µí•©ê³¼ ê°™ì´ ë¹Œë“œì™€ ì—°ë™í•˜ì—¬ ì§€ì†ì ìœ¼ë¡œ ì½”ë“œì— ëŒ€í•œ ì¸ìŠ¤í™ì…˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. 

- í’ˆì§ˆ ì¤‘ì•™í™”

  - ê°œë°œëœ ì¡°ì§ì˜ ì½”ë“œì˜ í’ˆì§ˆì„ ì¤‘ì•™ ì €ì¥ì†Œì—ì„œ ê°€ì‹œí™”í•˜ê³  ë‹¨ì¼ ìœ„ì¹˜ì—ì„œ ê´€ë¦¬í•©ë‹ˆë‹¤. 

- DevOpsì™€ì˜ í†µí•©

  - ë‹¤ì–‘í•œ ë¹Œë“œ ì‹œìŠ¤í…œ, CI ì—”ì§„ê³¼ í†µí•©ë˜ì–´ DevOps ì‹¤ì²œì„ ì§€ì›í•©ë‹ˆë‹¤. 

- í’ˆì§ˆ ìš”êµ¬ì‚¬í•­ ì„¤ì •

  - í’ˆì§ˆ ê²Œì´íŠ¸ë¥¼ í†µí•´ í‘œì¤€í™”ëœ ì½”ë“œ í’ˆì§ˆ ìš”êµ¬ì‚¬í•­ì„ ì„¤ì •í•©ë‹ˆë‹¤. 

- ë‹¤ì¤‘ ì–¸ì–´ ë¶„ì„

  - 20ê°œê°€ ë„˜ëŠ” í”„ë¡œê·¸ë¨ ì–¸ì–´ì— ëŒ€í•œ ì½”ë“œ ë¶„ì„ì„ ì§€ì›í•©ë‹ˆë‹¤. 

- í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ í™•ì¥

  - ë‹¤ìˆ˜ì˜ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ SonarQubeì˜ ê¸°ëŠ¥ì„ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

- ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸

  - ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë¡œ íŠ¹ì • ë²”ìœ„ê¹Œì§€ ë¬´ë£Œë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.

ì§€ê¸ˆë¶€í„°ëŠ” ì´ëŸ° ì¥ì ì´ ìˆëŠ” SonarQubeë¥¼ í”„ë¡œì íŠ¸ì— ì ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì†Œê°œí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤!

## í”„ë¡œì íŠ¸ì— SonarQube ì ìš©í•˜ê¸°

### ê°œë°œ í™˜ê²½

#### í”„ë¡œì íŠ¸

- Java 8

- Spring Boot 2.3.1

- Gradle 6.4.1

#### ì¸í”„ë¼

- Ubuntu 18.04

- Jenkins 2.249.3

- SonarQube Server 8.5.1

- SonarQube Scanner 4.5.0

í˜„ì¬ ì§ê³ ë˜ í”„ë¡œì íŠ¸ì˜ ê°œë°œ í™˜ê²½ì€ ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.

### ì„¤ì¹˜ í™˜ê²½ ì„¤ì •í•˜ê¸°

SonarQubeë¥¼ ì„¤ì¹˜í•˜ëŠ” ë°©ë²•ì€ **ì‹œìŠ¤í…œì— ì§ì ‘ ì„¤ì¹˜í•˜ëŠ” ë°©ë²•**ê³¼ **Dockerë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¤ì¹˜í•˜ëŠ” ë°©ë²•**ì´ ìˆìŠµë‹ˆë‹¤. ì €í¬ëŠ” í”„ë¡œì íŠ¸ ì „ë°˜ì— ê±¸ì²˜ Dockerë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— SonarQubeë„ Dockerë¥¼ í†µí•´ ì„¤ì¹˜ë¥¼ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.

> ì‹œìŠ¤í…œ í™˜ê²½ì€ AWS EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì„¤ëª…í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. OSë¡œëŠ” Ubuntu 18.04ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

> SonarQubeì˜ ì„¤ì¹˜ ë°©ë²•ì— ëŒ€í•´ ì¢€ ë” ìì„¸íˆ ì•Œì•„ë³´ê³  ì‹¶ì€ ë¶„ë“¤ì€ SonarQube ê³µì‹ ë¬¸ì„œì˜ [Try Out SonarQube](https://docs.sonarqube.org/latest/setup/get-started-2-minutes/)ë¥¼ ì°¸ê³ í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.

#### Docker ì„¤ì¹˜í•˜ê¸°

[Docker Document](https://docs.docker.com/engine/install/ubuntu/)ë¥¼ ì°¸ê³ í•˜ì—¬ ì„¤ì¹˜ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. ê³µì‹ ë¬¸ì„œì—ëŠ” í™˜ê²½ ì„¤ì •ì„ ì§ì ‘ í•˜ëŠ” ë°©ë²•ê³¼ ìŠ¤í¬ë¦½íŠ¸ë¡œ í•˜ëŠ” ë°©ë²•ì´ ìˆëŠ”ë°, SonarQubeì˜ ê²½ìš° ì‹¤ì œ Productê°€ ì˜¬ë¼ê°€ëŠ” ìƒí™©ì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— **ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ì§„í–‰**í•˜ì˜€ìŠµë‹ˆë‹¤.

> [Docker Document](https://docs.docker.com/engine/install/ubuntu/#install-using-the-convenience-script)ë¥¼ ë³´ë©´ **Using these scripts is not recommended for production environments** ê²½ê³ ë¬¸ì´ ìˆìŠµë‹ˆë‹¤. ì‹¤ì œ Product í™˜ê²½ì— Dockerë¥¼ ì„¤ì¹˜í•œë‹¤ë©´ ì§ì ‘ í™˜ê²½ ì„¤ì •ì„ í•˜ë©´ì„œ ì„¤ì¹˜í•˜ê¸°ë¥¼ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.

ë¨¼ì € EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ íŒ¨í‚¤ì§€ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ìš´ë°›ê¸° ìœ„í•´ curlì„ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.

```shell
sudo apt-get update
sudo apt-get curl
```

ê·¸ í›„ [ìŠ¤í¬ë¦½íŠ¸](https://get.docker.com/)ë¥¼ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì„¤ì¹˜í•˜ê³  ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤.

```shell
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
```

ì´ ìƒíƒœë¡œ ë§ˆì¹˜ë©´ Dockerë¥¼ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ë§¤ë²ˆ `sudo`ë¥¼ ì…ë ¥í•´ì•¼ í•˜ëŠ” ë¶ˆí¸í•¨ì´ ìˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ ê³„ì •ì„ docker ê·¸ë£¹ì— ì¶”ê°€í•˜ë©´ `sudo`ë¥¼ ì…ë ¥í•˜ì§€ ì•Šê³ ë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```shell
sudo usermod -aG docker $USER
```

#### SonarQube ì´ë¯¸ì§€ ì„¤ì¹˜í•˜ê¸°

Docker ì„¤ì¹˜ê°€ ì™„ë£Œëë‹¤ë©´ ì´ì œ SonarQube ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¤ë©´ ë©ë‹ˆë‹¤. [Docker Hub](https://hub.docker.com/_/sonarqube)ì—ì„œ SonarQubeì˜ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì™€ì„œ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```shell
docker pull sonarqube
```

ëª…ë ¹ì–´ í•œ ì¤„ë¡œ sonarqubeì˜ ì„¤ì¹˜ëŠ” ëì´ ë‚©ë‹ˆë‹¤! (ì—­ì‹œ Docker ìµœê³ ğŸ¤©)

ì´ë¯¸ì§€ê°€ ì˜ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€ëŠ” ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```shell
docker images
```

![docker image](./images/docker-image.png)

SonarQubeê°€ ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë¨ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### SonarQube ì‹¤í–‰í•˜ê¸°

ì´ì œ Dockerë¡œ ì„¤ì¹˜í•œ SonarQubeë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.

```shell
docker run -d --name sonarqube -p 8080:9000 sonarqube
```

- `-d` : ì»¨í…Œì´ë„ˆë¥¼ ì¼ë°˜ í”„ë¡œì„¸ìŠ¤ê°€ ì•„ë‹Œ ë°ëª¬ í”„ë¡œì„¸ìŠ¤ í˜•íƒœë¡œ ì‹¤í–‰í•˜ì—¬ í”„ë¡œì„¸ìŠ¤ê°€ ëë‚˜ë„ ìœ ì§€ë˜ë„ë¡ í•œë‹¤.

- `--name` : ì‹¤í–‰í•  ì»¨í…Œì´ë„ˆì˜ ì´ë¦„ì„ ì„¤ì •í•œë‹¤.

- `-p` : ì»¨í…Œì´ë„ˆì˜ í¬íŠ¸ë¥¼ í˜¸ìŠ¤íŠ¸ì˜ í¬íŠ¸ì™€ ë°”ì¸ë”©í•´ ì—°ê²°í•  ìˆ˜ ìˆë‹¤. `-p [host(ì™¸ë¶€)ì˜ port]:[container(ë‚´ë¶€)ì˜ port]`ì´ë‹¤.

SonarQubeì˜ ê²½ìš° **ê¸°ë³¸ì´ 9000 í¬íŠ¸**ì…ë‹ˆë‹¤. í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ EC2ê°€ 9000 í¬íŠ¸ëŠ” ì—´ë ¤ìˆì§€ ì•Šê³  8000 í¬íŠ¸ë§Œ ì—´ë ¤ìˆì–´ì„œ 8000 í¬íŠ¸ë¡œ ë°”ì¸ë”©í•˜ì˜€ìŠµë‹ˆë‹¤.

> SonarQubeì˜ ê¸°ë³¸ í¬íŠ¸ë¥¼ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´ SonarQube ì»¨í…Œì´ë„ˆì— ë“¤ì–´ê°„ í›„ `/config/sonar.properties` íŒŒì¼ì˜  `sonar.web.port` í”„ë¡œí¼í‹°ë¥¼ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤.

ì´ë ‡ê²Œ ì‹¤í–‰í•˜ê³  `http://[EC2 ì¸ìŠ¤í„´ìŠ¤ ip ì£¼ì†Œ]:[port ë²ˆí˜¸]`ë¡œ ì ‘ì†ì„ í•˜ë©´ ì‹¤í–‰ëœ SonarQubeë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì €í¬ í”„ë¡œì íŠ¸ì˜ ê²½ìš° 8000 í¬íŠ¸ë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— `http://x.x.x.x:8000`ë¡œ ì ‘ì†í•˜ì˜€ìŠµë‹ˆë‹¤.

ì²˜ìŒ ì ‘ì†í•˜ë©´ ë¡œê·¸ì¸ì„ í•´ì•¼í•˜ëŠ”ë° ê¸°ë³¸ IDì™€ ë¹„ë°€ë²ˆí˜¸ëŠ” ëª¨ë‘ adminì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì ‘ì†í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í˜ì´ì§€ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![sonarqube installed](./images/sonarqube-installed.png)

### Jenkins ì„¤ì •í•˜ê¸°

#### SonarQube Scanner í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜í•˜ê¸°

í”„ë¡œì íŠ¸ì— ì ìš©í•œ Jenkinsì— **SonarQube Scanner í”ŒëŸ¬ê·¸ì¸**ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.

![jenkins manage](./images/jenkins-manage.png)

![jenkins plugins](./images/jenkins-plugins.png)

![jenkins sonarqube scanner](./images/jenkins-sonarqube-scanner.png)

Jenkinsì˜ Manage Jenkins > Manage Plugins > Availableì—ì„œ SonarQube Scanner for Jenkinsë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

> ìœ„ ì‚¬ì§„ì€ Jenkinsì— ì´ë¯¸ SonarQube Scannerë¥¼ ì„¤ì¹˜í–ˆê¸° ë•Œë¬¸ì— Installedì—ì„œ ì¡°íšŒê°€ ëœ ëª¨ìŠµì…ë‹ˆë‹¤.

#### SonarQube Server ì„¤ì •í•˜ê¸°

í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ê°€ ì™„ë£Œë˜ë©´ Jenkinsì— SonarQube Serverì— ëŒ€í•œ ì„¤ì •ì„ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” Manage Jenkins > Configure System > SonarQube Serverì—ì„œ ì„¤ì •ì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.

![jenkins configure](./images/jenkins-configure.png)

![jenkins sonarqube server](./images/jenkins-sonarqube-server.png)

ë¨¼ì € Enable injection of SonarQube server configuration as build environment variablesë¥¼ ì²´í¬í•©ë‹ˆë‹¤.

ê·¸ë¦¬ê³  Nameì—ëŠ” ì„¤ì •í•˜ê³  ì‹¶ì€ ì´ë¦„ì„ ì…ë ¥í•˜ê³  Server URLì€ ì„¤ì¹˜í•œ SonarQube Serverì˜ ì£¼ì†Œë¥¼ ì…ë ¥í•©ë‹ˆë‹¤. Server authentication tokenì˜ ê²½ìš°ëŠ” ë”°ë¡œ ì„¤ì •í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.

#### SonarQube Scanner ì„¤ì •í•˜ê¸°

Jenkins ì„¤ì •ì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ SonarQube Scannerë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. Manage Jenkins > Global Tool Configuration > SonarQube serversì—ì„œ ì„¤ì •ì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.

![jenkins global tool](./images/jenkins-global-tool.png)

![jenkins sonarqube scanner setting](./images/jenkins-sonarqube-scanner-setting.png)

ì´ë•Œ Nameì˜ ê²½ìš° ì¶”í›„ Jenkinsfileì„ ì„¤ì •í•  ë•Œ ì‚¬ìš©í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì˜ ê¸°ì–µí•´ë‘ì–´ì•¼ í•©ë‹ˆë‹¤.

SonarQube Scanner Installerë¡œ ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ìˆì§€ë§Œ ê·¸ ì¤‘ì—ì„œ ê°€ì¥ ê°„ë‹¨í•œ Maven Centralì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

### Gradle ì„¤ì •í•˜ê¸°

#### SonarQube í”ŒëŸ¬ê·¸ì¸ ì˜ì¡´ì„± ì¶”ê°€

ì´ì œ SonarQubeë¡œ ì†ŒìŠ¤ ì½”ë“œë¥¼ ë¶„ì„í•˜ëŠ” ì„¤ì •ì„ í•˜ê² ìŠµë‹ˆë‹¤. SonarQubeë¡œ ì†ŒìŠ¤ ì½”ë“œë¥¼ ë¶„ì„í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆëŠ”ë° ê·¸ ì¤‘ì—ì„œ í”„ë¡œì íŠ¸ì˜ Gradle Taskë¥¼ í†µí•´ ë¶„ì„í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.

> [SonarQube Document - Analyzing Source Code](https://docs.sonarqube.org/latest/analysis/overview/)ì— ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì´ ì†Œê°œë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ë¨¼ì € í”„ë¡œì íŠ¸ì˜ ê¸°ë³¸ `build.gradle`ì— [SonarQube í”ŒëŸ¬ê·¸ì¸ ì˜ì¡´ì„±](https://plugins.gradle.org/plugin/org.sonarqube)ì„ ì¶”ê°€í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

```java
plugins {
    id 'org.sonarqube' version '3.0'
}
```

#### SonarQube Property ì„¤ì •

í˜„ì¬ í”„ë¡œì íŠ¸ êµ¬ì¡°ê°€ ë©€í‹° ëª¨ë“ˆì´ê¸° ë•Œë¬¸ì— `build.gradle`ì˜ `subprojects`ì—ë„ ì„¤ì •ì„ ì¶”ê°€í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

> í”„ë¡œì íŠ¸ì˜ ë©€í‹° ëª¨ë“ˆ êµ¬ì¡°ì— ëŒ€í•œ ë‚´ìš©ì€ [ì´ì „ ê¸€](https://seller-lee.github.io/java-code-coverage-tool-part2)ì„ ì°¸ê³ í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.

```java
subprojects {
    apply plugin: 'org.sonarqube'

    sonarqube {
        properties {
            property 'sonar.host.url', 'http://[EC2 ì¸ìŠ¤í„´ìŠ¤ ip ì£¼ì†Œ]:[í¬íŠ¸ ë²ˆí˜¸]'
            property 'sonar.login', 'SonarQube ë¡œê·¸ì¸ í† í°'
            property 'sonar.sources', 'src'
            property 'sonar.language', 'java'
            property 'sonar.projectVersion', '1.1.0-SNAPSHOT'
            property 'sonar.sourceEncoding', 'UTF-8'
            property 'sonar.coverage.jacoco.xmlReportPaths', '${buildDir}/reports/jacoco/test/jacocoTestReport.xml'
            property 'sonar.java.binaries', '${buildDir}/classes'
            property 'sonar.test.inclusions', '**/*Test.java'
            property 'sonar.exclusions', '**/test/**, **/Q*.java, **/*Doc*.java, **/resources/**'
        }
    }
}
```

sonarqube.propertyì— ëŒ€í•´ ê°„ë‹¨íˆ ì•Œì•„ë³´ë©´

- `sonar.host.url` : ì„¤ì¹˜í•œ SonarQubeì˜ ì£¼ì†Œì´ë‹¤. ì•ì„œ ì  í‚¨ìŠ¤ì˜ SonarQube Serverì— ì…ë ¥í•œ ì£¼ì†Œì™€ ë™ì¼í•˜ë‹¤.

- `sonar.login` : SonarQube Serverì— ë¡œê·¸ì¸í•˜ì—¬ ë°œê¸‰ë°›ì€ í† í°ì´ë‹¤.

  ![sonarqube administration](./images/sonarqube-administration.png)

  ![sonarqube security](./images/sonarqube-security.png)

  ![sonarqube user](./images/sonarqube-user.png)

  SonarQube Server í˜ì´ì§€ì—ì„œ Administration > Security > Users > Tokensì—ì„œ í† í°ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í† í°ì˜ ê²½ìš° í•œ ë²ˆ ë°œê¸‰ë°›ìœ¼ë©´ ì´í›„ì— ë‹¤ì‹œ í† í°ì„ í™•ì¸í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì˜ ì €ì¥í•´ë‘¬ì•¼ í•©ë‹ˆë‹¤.

  ì—¬ê¸°ì„œ ë°œê¸‰ë°›ì€ í† í°ì„ í•´ë‹¹ í”„ë¡œí¼í‹°ì˜ ê°’ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ë©ë‹ˆë‹¤.

- `sonar.sources` : ë¶„ì„í•  ì†ŒìŠ¤ íŒŒì¼ì˜ ê³µí†µ ê²½ë¡œë¥¼ ì§€ì •í•œë‹¤.

- `sonar.language` : ì‘ì„±í•œ ì½”ë“œì˜ ì–¸ì–´ë¥¼ ì„ íƒí•œë‹¤. javaì˜ ê²½ìš° ì»¤ë®¤ë‹ˆí‹° ë²„ì „ì—ì„œ ë¬´ë£Œë¡œ ì •ì  ë¶„ì„ì„ í•  ìˆ˜ ìˆë‹¤.

- `sonar.projectVersion` : SonarQubeì—ì„œ ë¶„ì„í•œ ì†ŒìŠ¤ì˜ ë²„ì „ì„ ì§€ì •í•œë‹¤.

- `sonar.coverage.jacoco.xmlReportPaths` : JaCoCoê°€ ë¶„ì„í•œ ê²°ê³¼ì— í•´ë‹¹í•˜ëŠ” xml íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ì»¤ë²„ë¦¬ì§€ë¥¼ ë¶„ì„í•œë‹¤. JaCoCoê°€ ìƒì„±í•˜ëŠ” xml reportì˜ ê¸°ë³¸ ê²½ë¡œê°€ `${buildDir}/reports/jacoco/test/jacocoTestReport.xml`ì´ë‹¤.

- `sonar.java.binaries` : Javaê°€ ì»´íŒŒì¼ë˜ë©´ì„œ ìƒì„±ëœ ë°”ì´ë„ˆë¦¬ íŒŒì¼ì„ ë¶„ì„í•œë‹¤.

  í•´ë‹¹ í”„ë¡œí¼í‹°ë¥¼ ì„¤ì •í•˜ë©´ ë³´ë‹¤ ì •í™•í•œ ì½”ë“œ ë¶„ì„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œë„ í•´ë‹¹ í”„ë¡œí¼í‹°ì˜ ì„¤ì •ë§Œìœ¼ë¡œ ì½”ë“œ ë¶„ì„ì˜ ì •í™•ë„ê°€ ì¦ê°€í•¨ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

  - í”„ë¡œí¼í‹° ì ìš© ì „
    
    ![sonarqube not binary](./images/sonarqube-not-binary.png)
    
  - í”„ë¡œí¼í‹° ì ìš© í›„(ì½”ë“œ ë³€ê²½ X)
    
    ![sonarqube binary](./images/sonarqube-binary.png)
    
- `sonar.test.inclusion` : ë¶„ì„ì— ì‚¬ìš©í•  í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ìœ„ì¹˜ë¥¼ ì§€ì •í•œë‹¤. `**/*Test.java` ì˜ ê²½ìš° `src` í•˜ìœ„ì˜ ëª¨ë“  ë””ë ‰í† ë¦¬ì—ì„œ Test.javaë¡œ ëë‚˜ëŠ” íŒŒì¼ì„ ì˜ë¯¸í•œë‹¤.

- `sonar.exclusions` : ì»¤ë²„ë¦¬ì§€ ë¶„ì„ì—ì„œ ì œì™¸í•  íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì§€ì •í•œë‹¤.

#### ì„œë¸Œ ëª¨ë“ˆ Property ì„¤ì •í•˜ê¸°

ë©€í‹° ëª¨ë“ˆ êµ¬ì¡°ì—ì„œ ëª¨ë“ˆë³„ë¡œ í”„ë¡œí¼í‹°ë¥¼ ì ìš©í•˜ê³  ì‹¶ë‹¤ë©´ í•´ë‹¹ ëª¨ë“ˆ í•˜ìœ„ì˜ `build.gradle` íŒŒì¼ì— ì„¤ì •ì„ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.

```java
sonarqube {
    properties {
        property 'sonar.exclusions', '**/test/**'
    }
}
```

ì¶”ê°€ì ìœ¼ë¡œ í”„ë¡œí¼í‹°ì— í´ë” ê²½ë¡œë‚˜ íŒŒì¼ ê²½ë¡œë¥¼ íŒ¨í„´ì„ í†µí•´ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- `*` : 0ê°œ ë˜ëŠ” ê·¸ ì´ìƒì˜ ë¬¸ìë¥¼ ì˜ë¯¸í•œë‹¤.

- `**` : 0ê°œ ë˜ëŠ” ê·¸ ì´ìƒì˜ ë””ë ‰í† ë¦¬ë¥¼ ì˜ë¯¸í•œë‹¤.

- `?` : í•˜ë‚˜ì˜ ë¬¸ìì— í•´ë‹¹í•œë‹¤.

### Jenkins Stageì— SonarQube ë¶„ì„ ì¶”ê°€í•˜ê¸°

ì´ì œ ìœ„ì—ì„œ ì„¤ì •í•œ SonarQube Gradle Taskë¥¼ ì‹¤í–‰í•˜ëŠ” Jenkins Stageë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” SonarQube ì½”ë“œ ë¶„ì„ì„ ë¹Œë“œ ì‹œì ì—ì„œ ì‹¤í–‰í•˜ì§€ ì•Šê³  Jenkinsê°€ ë¶„ì„í•˜ëŠ” ì‹œì ì—ì„œ ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

> ë¹Œë“œ ì‹œì ì—ì„œ ì‹¤í–‰í•˜ë ¤ë©´ JaCoCo Gradle Task ì„¤ì •ì—ì„œ ì‚¬ìš©í•œ `finalizedBy`ì™€ ê°™ì€ í•¨ìˆ˜ë¡œ ì‹¤í–‰ ìˆœì„œë¥¼ ê·œì •í•˜ë©´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

ì´ëŠ” í”„ë¡œì íŠ¸ì˜ jenkinsfileì„ í†µí•´ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.

```shell
node {
    stage ('clone') {
        checkout scm
    }
    stage('build') {
        sh 'cd back && ./gradlew api:clean api:build && ./gradlew chat:clean chat:build'
    }
    stage('SonarQube analysis') {
      withSonarQubeEnv('SonarQube') {
        sh 'cd back && ./gradlew --info sonarqube' +
        ' -Dsonar.projectKey=Jikgorae-' + env.BRANCH_NAME +
        ' -Dsonar.projectName=Jikgorae-' + env.BRANCH_NAME
      }
    }
}
```

`clone` stageì™€ `build` stageëŠ” ê¸°ì¡´ì— ì¡´ì¬í•˜ë˜ ì„¤ì •ì´ê³  `SonarQube analysis` stage ì„¤ì •ì„ ì´ë²ˆì— ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.

`withSonarQubeEnv()` í•¨ìˆ˜ì˜ ì¸ìë¡œ ë“¤ì–´ê°€ëŠ” `'SonarQube'`ëŠ” ì•ì—ì„œ ì„¤ì •í•œ Jenkinsì˜ SonarQube Scanner ì´ë¦„ì…ë‹ˆë‹¤. í•´ë‹¹ ì´ë¦„ê³¼ ê°™ì€ SonarQube Scannerë¥¼ ì‚¬ìš©í•˜ì—¬ ì•„ë˜ì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

ì´ë•Œ `-D` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ **ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œì ì—ì„œ í”„ë¡œí¼í‹°ë¥¼ ì¶”ê°€**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìœ„ ì„¤ì •ì˜ ê²½ìš° projectKeyì™€ projectNameì„ í˜„ì¬ ë¸Œëœì¹˜ì˜ ì´ë¦„ìœ¼ë¡œ ì„¤ì •í•˜ë„ë¡ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ê° í”„ë¡œí¼í‹° ì‚¬ì´ì—ëŠ” ê³µë°±ì´ ìˆì–´ì•¼ì§€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

ìœ„ì˜ ì„¤ì •ì´ ì™„ë£Œë˜ë©´ Jenkinsê°€ ë¶„ì„í•˜ë©´ì„œ í•¨ê»˜ SonarQube analysis Stageë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

> ì €í¬ í”„ë¡œì íŠ¸ì˜ ê²½ìš° PRì„ í†µí•´ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê³ , ì´ë¥¼ developì— mergeí•˜ëŠ”(ê·¸ë¦¬ê³  developì„ masterë¡œ mergeí•˜ëŠ”) ì „í˜•ì ì¸ git-flow ë¸Œëœì¹˜ ì „ëµì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.
>
> ë”°ë¼ì„œ PRì´ ìƒì„±ë˜ëŠ” ì‹œì (ë¸Œëœì¹˜ê°€ ìƒˆë¡œ ìƒì„± & ìƒˆë¡œìš´ ì»¤ë°‹, í‘¸ì‰¬), develop ë˜ëŠ” masterì— ë¨¸ì§€ë˜ëŠ” ì‹œì ì— SonarQube analysis Stageê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.

![sonarqube stage](./images/sonarqube-stage.png)

### SonarQube Server í”„ë¡œì íŠ¸

SonarQube ì½”ë“œ ë¶„ì„ì´ ì •ìƒì ìœ¼ë¡œ ë§ˆë¬´ë¦¬ ëë‹¤ë©´ SonarQube í”„ë¡œì íŠ¸ê°€ ìƒì„±ë  ê²ƒì…ë‹ˆë‹¤.

![sonarqube project](./images/sonarqube-project.png)

ì œê°€ í•œ ì„¤ì •ì€ ë¸Œëœì¹˜(PR, develop) ë³„ë¡œ í•˜ë‚˜ì˜ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

>  í”„ë¡œì íŠ¸ë¥¼ í•˜ë‚˜ë§Œ ë‘ê³  í•œ í”„ë¡œì íŠ¸ì—ì„œ ì—¬ëŸ¬ ë¸Œëœì¹˜ë¡œ ê´€ë¦¬í•  ìˆ˜ë„ ìˆì§€ë§Œ ì´ëŠ” ë¬´ë£Œ ë²„ì „ì¸ Community ë²„ì „ì—ì„œëŠ” ì§€ì›ë˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥ì´ì–´ì„œ ì ìš©í•˜ì§€ ëª»í•˜ì˜€ìŠµë‹ˆë‹¤.

![sonarqube project detail](./images/sonarqube-project-detail.png)

![sonarqube project coverage](./images/sonarqube-project-coverage.png)

![sonarqube project code smell](./images/sonarqube-codesmell.png)

SonarQube í”„ë¡œì íŠ¸ë¥¼ í´ë¦­í•˜ë©´ ìœ„ì™€ ê°™ì´ ìƒì„¸í•œ ì •ë³´ë“¤ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. SonarQubeì—ì„œ ê´€ë¦¬í•´ì£¼ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ í’ˆì§ˆì— ëŒ€í•´ ê°„ë‹¨í•˜ê²Œ ì†Œê°œí•´ë³´ë©´

- Code Smell : ì‹¬ê°í•œ ì´ìŠˆëŠ” ì•„ë‹ˆì§€ë§Œ ë² ìŠ¤íŠ¸ í”„ë ‰í‹°ìŠ¤ì—ì„œ ì‚¬ì†Œí•œ ì´ìŠˆë“¤ë¡œ ëª¨ë“ˆì„±(modularity), ì´í•´ê°€ëŠ¥ì„±(understandability), ë³€ê²½ê°€ëŠ¥ì„±(changeability), í…ŒìŠ¤íŠ¸ìš©ì˜ì„±(testability), ì¬ì‚¬ìš©ì„±(reusability) ë“±ì´ í¬í•¨ëœë‹¤.

- Bugs : ì¼ë°˜ì ìœ¼ë¡œ ì ì¬ì ì¸ ë²„ê·¸ í˜¹ì€ ì‹¤í–‰ì‹œê°„ì— ì˜ˆìƒë˜ëŠ” ë™ì‘ì„ í•˜ì§€ ì•ŠëŠ” ì½”ë“œë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.

- Vulnerabilities : í•´ì»¤ë“¤ì—ê²Œ ì ì¬ì ì¸ ì•½ì ì´ ë  ìˆ˜ ìˆëŠ” ë³´ì•ˆìƒì˜ ì´ìŠˆë¥¼ ë§í•œë‹¤. SQL ì¸ì ì…˜, í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…ê³¼ ê°™ì€ ë³´ì•ˆ ì·¨ì•½ì„±ì„ ì°¾ì•„ë‚¸ë‹¤.

- Duplications : ì½”ë“œ ì¤‘ë³µì€ ì½”ë“œì˜ í’ˆì§ˆì„ ì €í•´ì‹œí‚¤ëŠ” ê°€ì¥ í° ìš”ì¸ ì¤‘ í•˜ë‚˜ì´ë‹¤.

- Unit Test : ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ë¥¼ í†µí•´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ ìˆ˜í–‰ ì •ë„ì™€ ìˆ˜í–‰í•œ í…ŒìŠ¤íŠ¸ì˜ ì„±ê³µ/ì‹¤íŒ¨ ì •ë³´ë¥¼ ì œê³µí•œë‹¤.

- Complexity : ì½”ë“œì˜ ìˆœí™˜ ë³µì¡ë„, ì¸ì§€ ë³µì¡ë„ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤.

- Size : ì†ŒìŠ¤ì½”ë“œ ì‚¬ì´ì¦ˆì™€ ê´€ë ¨ëœ ë‹¤ì–‘í•œ ì§€í‘œë¥¼ ì œê³µí•©ë‹ˆë‹¤.

~~(SonarQubeë¥¼ ì ìš©í•œ ì§í›„ì—¬ì„œ ì•„ì§ Code smellì´ ë§ì€ ì  ì´í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤...ğŸ˜…)~~

## ì •ë¦¬í•˜ë©°

ì´ë²ˆ ê¸€ì—ì„œëŠ” ì €í¬ í”„ë¡œì íŠ¸ì—ì„œ **ì •ì  ì½”ë“œ ë¶„ì„ ë„êµ¬ì¸ SonarQubeë¥¼ ì–´ë–»ê²Œ ì ìš©í–ˆëŠ”ì§€**ë¥¼ ê°„ë‹¨íˆ ì†Œê°œí•´ë³´ì•˜ìŠµë‹ˆë‹¤.

ì½”ë“œì˜ í’ˆì§ˆ ê°œì„ ì€ í”„ë¡œì íŠ¸ê°€ ì˜¤ëœ ê¸°ê°„ ìœ ì§€ë³´ìˆ˜ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì½”ë“œ ì»¤ë²„ë¦¬ì§€(JaCoCo)ì™€ ê°™ì€ ë™ì  ì½”ë“œ ë¶„ì„, ì½”ë“œ í’ˆì§ˆ ë¶„ì„(SonarQube)ê³¼ ê°™ì€ ì •ì  ì½”ë“œ ë¶„ì„ì€ í”„ë¡œì íŠ¸ì˜ ì½”ë“œ í’ˆì§ˆ ê°œì„ ì— ë§ì€ ë„ì›€ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì½”ë“œë§Œ ì‘ì„±í•œë‹¤ê³  ë!!!ì´ ì•„ë‹ˆë¼ ì§€ì†ì ìœ¼ë¡œ ë¬¸ì œê°€ ë°œìƒ ê°€ëŠ¥í•œ ë¶€ë¶„ì„ ìˆ˜ì •í•˜ë©´ì„œ ê°œì„ í•´ë‚˜ê°„ë‹¤ë©´ ë” ì¢‹ì€ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì„ ê²ƒì´ë¼ ìƒê°í•©ë‹ˆë‹¤ :)

ë‹¤ìŒ ê¸€ì—ì„œëŠ” JaCoCoì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ íš¨ê³¼ê°€ **ë°°**ê°€ ë˜ëŠ”, **SonarQube**ì˜ í”„ë¡œì íŠ¸ ì ìš© ë°©ë²•ì„ ì†Œê°œí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ì½”ë“œ ì»¤ë²„ë¦¬ì§€ ë¶„ì„ ë„êµ¬ & ì •ì  ì½”ë“œ ë¶„ì„ ë„êµ¬ ì ìš©ê¸°ë¥¼ ì—¬ê¸°ì„œ ë§ˆì¹˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ê¸´ ê¸€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ™‡ğŸ»â€â™‚ï¸

### ê´€ë ¨ í¬ìŠ¤íŒ…

- [ì½”ë“œ ë¶„ì„ ë„êµ¬ ì ìš©ê¸° - 1í¸, ì½”ë“œ ì»¤ë²„ë¦¬ì§€(Code Coverage)ê°€ ë­”ê°€ìš”?](https://lxxjn0-dev.netlify.app/java-code-coverage-tool-part-1)

- [ì½”ë“œ ë¶„ì„ ë„êµ¬ ì ìš©ê¸° - 2í¸, JaCoCo ì ìš©í•˜ê¸°](https://lxxjn0-dev.netlify.app/java-code-coverage-tool-part-2)

### ì°¸ê³  ë§í¬ 

> [ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆ ê²€ìˆ˜ ë°©ë²• ì‚´í´ë³´ê¸° - LINE Engineering](https://engineering.linecorp.com/ko/blog/static-analysis-of-java-app/)
> 
> [[ë„ì»¤ ìŠ¤í„°ë”” #2] ê°œë°œí™˜ê²½ ì„¸íŒ… ë° ë°°í¬ ì‹¤ìŠµ - Roseline Song](https://roseline124.github.io/kuberdocker/2019/07/17/docker-study02.html)
> 
> [Sonarqube - 2 (ë„ì»¤ë¡œ ì„¤ì¹˜í•˜ê¸°) - Beom Dev Log](https://beomseok95.tistory.com/200)
> 
> [ì†Œë‚˜íë¸Œ(SonarQube) ì„¤ì¹˜ ë° IntelliJì™€ ì—°ë™í•´ì„œ ì½”ë“œ ì •ì ë¶„ì„í•˜ê¸° - í•´ì–´ë¦° ë¸”ë¡œê·¸](https://shinsunyoung.tistory.com/64)
> 
> [SonarQube Scans in Jenkins Declarative Pipeline using SonarScanner - Igorski.co](https://igorski.co/sonarqube-scans-using-jenkins-declarative-pipelines/)
> 
> [SonarQube ì†Œê°œ - CURVE](https://confluence.curvc.com/pages/viewpage.action?pageId=6160780#id-1.SonarQube%EC%86%8C%EA%B0%9C-1.CodeSmells(Maintainability))